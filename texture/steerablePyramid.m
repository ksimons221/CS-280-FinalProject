function [ out_im ] = steerablePyramid( im )
%% Hard coded filter matrices
 H0 = ...
[ 0.001442 , -0.0007801, -0.001878 , -0.0001538,  0.001893 ,  0.00171 ,  0.0008252,  0.0009354,  0.001205 ,  0.0009354,  0.0008252,  0.00171 ,  0.001893 , -0.0001538, -0.001878 , -0.0007801,  0.001442 ;
 -0.0007801,  0.0001039,  0.001319 ,  0.0006535, -0.001211 , -0.002221, -0.002332 , -0.002008 , -0.001773 , -0.002008 , -0.002332 , -0.002221, -0.001211 ,  0.0006535,  0.001319 ,  0.0001039, -0.0007801;
 -0.001878 ,  0.001319 ,  0.002019 , -0.0001533, -0.001903 , -0.001488, -0.0002493,  0.0001507,  0.0001271,  0.0001507, -0.0002493, -0.001488, -0.001903 , -0.0001533,  0.002019 ,  0.001319 , -0.001878 ;
 -0.0001538,  0.0006535, -0.0001533, -0.001087 , -0.0008719,  0.002463,  0.006054 ,  0.005629 ,  0.004467 ,  0.005629 ,  0.006054 ,  0.002463, -0.0008719, -0.001087 , -0.0001533,  0.0006535, -0.0001538;
  0.001893 , -0.001211 , -0.001903 , -0.0008719,  0.002431 ,  0.004563, -0.001195 , -0.00956  , -0.01276  , -0.00956  , -0.001195 ,  0.004563,  0.002431 , -0.0008719, -0.001903 , -0.001211 ,  0.001893 ;
  0.00171  , -0.002221 , -0.001488 ,  0.002463 ,  0.004563 , -0.007841, -0.01544  , -0.002709 ,  0.006149 , -0.002709 , -0.01544  , -0.007841,  0.004563 ,  0.002463 , -0.001488 , -0.002221 ,  0.00171  ;
  0.0008252, -0.002332 , -0.0002493,  0.006054 , -0.001195 , -0.01544 ,  0.01788  ,  0.0453   ,  0.03733  ,  0.0453   ,  0.01788  , -0.01544 , -0.001195 ,  0.006054 , -0.0002493, -0.002332 ,  0.0008252;
  0.0009354, -0.002008 ,  0.0001507,  0.005629 , -0.00956  , -0.002709,  0.0453   , -0.06143  , -0.1903   , -0.06143  ,  0.0453   , -0.002709, -0.00956  ,  0.005629 ,  0.0001507, -0.002008 ,  0.0009354;
  0.001205 , -0.001773 ,  0.0001271,  0.004467 , -0.01276  ,  0.006149,  0.03733  , -0.1903   ,  0.5896   , -0.1903   ,  0.03733  ,  0.006149, -0.01276  ,  0.004467 ,  0.0001271, -0.001773 ,  0.001205 ;
  0.0009354, -0.002008 ,  0.0001507,  0.005629 , -0.00956  , -0.002709,  0.0453   , -0.06143  , -0.1903   , -0.06143  ,  0.0453   , -0.002709, -0.00956  ,  0.005629 ,  0.0001507, -0.002008 ,  0.0009354;
  0.0008252, -0.002332 , -0.0002493,  0.006054 , -0.001195 , -0.01544 ,  0.01788  ,  0.0453   ,  0.03733  ,  0.0453   ,  0.01788  , -0.01544 , -0.001195 ,  0.006054 , -0.0002493, -0.002332 ,  0.0008252;
  0.00171  , -0.002221 , -0.001488 ,  0.002463 ,  0.004563 , -0.007841, -0.01544  , -0.002709 ,  0.006149 , -0.002709 , -0.01544  , -0.007841,  0.004563 ,  0.002463 , -0.001488 , -0.002221 ,  0.00171  ;
  0.001893 , -0.001211 , -0.001903 , -0.0008719,  0.002431 ,  0.004563, -0.001195 , -0.00956  , -0.01276  , -0.00956  , -0.001195 ,  0.004563,  0.002431 , -0.0008719, -0.001903 , -0.001211 ,  0.001893 ;
 -0.0001538,  0.0006535, -0.0001533, -0.001087 , -0.0008719,  0.002463,  0.006054 ,  0.005629 ,  0.004467 ,  0.005629 ,  0.006054 ,  0.002463, -0.0008719, -0.001087 , -0.0001533,  0.0006535, -0.0001538;
 -0.001878 ,  0.001319 ,  0.002019 , -0.0001533, -0.001903 , -0.001488, -0.0002493,  0.0001507,  0.0001271,  0.0001507, -0.0002493, -0.001488, -0.001903 , -0.0001533,  0.002019 ,  0.001319 , -0.001878 ;
 -0.0007801,  0.0001039,  0.001319 ,  0.0006535, -0.001211 , -0.002221, -0.002332 , -0.002008 , -0.001773 , -0.002008 , -0.002332 , -0.002221, -0.001211 ,  0.0006535,  0.001319 ,  0.0001039, -0.0007801;
  0.001442 , -0.0007801, -0.001878 , -0.0001538,  0.001893 ,  0.00171 ,  0.0008252,  0.0009354,  0.001205 ,  0.0009354,  0.0008252,  0.00171 ,  0.001893 , -0.0001538, -0.001878 , -0.0007801,  0.001442 ];

 L0 = ...
[  0.0005885 , -0.001269 ,  0.0006729,  0.0003519,  0.0001239, -0.0004417, -0.0007626,  4.539e-005, -0.0004016,  4.539e-005, -0.0007626, -0.0004417,  0.0001239,  0.0003519,  0.0006729, -0.001269 ,  0.0005885 ;
  -0.001269  ,  0.00221  , -0.0003249, -0.001374 , -0.000351 ,  0.001396 ,  0.001633 ,  0.0001148 ,  0.0001493,  0.0001148 ,  0.001633 ,  0.001396 , -0.000351 , -0.001374 , -0.0003249,  0.00221  , -0.001269  ;
   0.0006729 , -0.0003249, -0.001898 ,  0.002239 ,  0.0006064, -0.002614 , -0.001944 , -0.000533  ,  0.001326 , -0.000533  , -0.001944 , -0.002614 ,  0.0006064,  0.002239 , -0.001898 , -0.0003249,  0.0006729 ;
   0.0003519 , -0.001374 ,  0.002239 , -0.001173 , -0.001963 ,  0.003672 ,  0.004728 ,  0.001394  , -0.001157 ,  0.001394  ,  0.004728 ,  0.003672 , -0.001963 , -0.001173 ,  0.002239 , -0.001374 ,  0.0003519 ;
   0.0001239 , -0.000351 ,  0.0006064, -0.001963 ,  0.004481 , -0.00173  , -0.01139  , -0.006606  , -0.004429 , -0.006606  , -0.01139  , -0.00173  ,  0.004481 , -0.001963 ,  0.0006064, -0.000351 ,  0.0001239 ;
  -0.0004417 ,  0.001396 , -0.002614 ,  0.003672 , -0.00173  , -0.007913 ,  0.01373  ,  0.02436   ,  0.01898  ,  0.02436   ,  0.01373  , -0.007913 , -0.00173  ,  0.003672 , -0.002614 ,  0.001396 , -0.0004417 ;
  -0.0007626 ,  0.001633 , -0.001944 ,  0.004728 , -0.01139  ,  0.01373  ,  0.007779 , -0.04874   , -0.06167  , -0.04874   ,  0.007779 ,  0.01373  , -0.01139  ,  0.004728 , -0.001944 ,  0.001633 , -0.0007626 ;
   4.539e-005,  0.0001148, -0.000533 ,  0.001394 , -0.006606 ,  0.02436  , -0.04874  ,  0.02289   ,  0.1893   ,  0.02289   , -0.04874  ,  0.02436  , -0.006606 ,  0.001394 , -0.000533 ,  0.0001148,  4.539e-005;
  -0.0004016 ,  0.0001493,  0.001326 , -0.001157 , -0.004429 ,  0.01898  , -0.06167  ,  0.1893    ,  0.5236   ,  0.1893    , -0.06167  ,  0.01898  , -0.004429 , -0.001157 ,  0.001326 ,  0.0001493, -0.0004016 ;
   4.539e-005,  0.0001148, -0.000533 ,  0.001394 , -0.006606 ,  0.02436  , -0.04874  ,  0.02289   ,  0.1893   ,  0.02289   , -0.04874  ,  0.02436  , -0.006606 ,  0.001394 , -0.000533 ,  0.0001148,  4.539e-005;
  -0.0007626 ,  0.001633 , -0.001944 ,  0.004728 , -0.01139  ,  0.01373  ,  0.007779 , -0.04874   , -0.06167  , -0.04874   ,  0.007779 ,  0.01373  , -0.01139  ,  0.004728 , -0.001944 ,  0.001633 , -0.0007626 ;
  -0.0004417 ,  0.001396 , -0.002614 ,  0.003672 , -0.00173  , -0.007913 ,  0.01373  ,  0.02436   ,  0.01898  ,  0.02436   ,  0.01373  , -0.007913 , -0.00173  ,  0.003672 , -0.002614 ,  0.001396 , -0.0004417 ;
   0.0001239 , -0.000351 ,  0.0006064, -0.001963 ,  0.004481 , -0.00173  , -0.01139  , -0.006606  , -0.004429 , -0.006606  , -0.01139  , -0.00173  ,  0.004481 , -0.001963 ,  0.0006064, -0.000351 ,  0.0001239 ;
   0.0003519 , -0.001374 ,  0.002239 , -0.001173 , -0.001963 ,  0.003672 ,  0.004728 ,  0.001394  , -0.001157 ,  0.001394  ,  0.004728 ,  0.003672 , -0.001963 , -0.001173 ,  0.002239 , -0.001374 ,  0.0003519 ;
   0.0006729 , -0.0003249, -0.001898 ,  0.002239 ,  0.0006064, -0.002614 , -0.001944 , -0.000533  ,  0.001326 , -0.000533  , -0.001944 , -0.002614 ,  0.0006064,  0.002239 , -0.001898 , -0.0003249,  0.0006729 ;
  -0.001269  ,  0.00221  , -0.0003249, -0.001374 , -0.000351 ,  0.001396 ,  0.001633 ,  0.0001148 ,  0.0001493,  0.0001148 ,  0.001633 ,  0.001396 , -0.000351 , -0.001374 , -0.0003249,  0.00221  , -0.001269  ;
   0.0005885 , -0.001269 ,  0.0006729,  0.0003519,  0.0001239, -0.0004417, -0.0007626,  4.539e-005, -0.0004016,  4.539e-005, -0.0007626, -0.0004417,  0.0001239,  0.0003519,  0.0006729, -0.001269 ,  0.0005885 ];

 L1 = ...
[ 0.0001054,  0.0001806 ,  0.0001194 , -0.0002361 , -0.000765 , -0.001149 , -0.001186 , -0.0009932, -0.0008756, -0.0009932, -0.001186 , -0.001149 , -0.000765 , -0.0002361 ,  0.0001194 ,  0.0001806 ,  0.0001054;
  0.0001806, -6.354e-005, -0.0002745 , -0.0001713 ,  0.0002645,  0.0007913,  0.001152 ,  0.001289 ,  0.00131  ,  0.001289 ,  0.001152 ,  0.0007913,  0.0002645, -0.0001713 , -0.0002745 , -6.354e-005,  0.0001806;
  0.0001194, -0.0002745 , -0.0004537 ,  8.738e-005,  0.001129 ,  0.001903 ,  0.001887 ,  0.00135  ,  0.00104  ,  0.00135  ,  0.001887 ,  0.001903 ,  0.001129 ,  8.738e-005, -0.0004537 , -0.0002745 ,  0.0001194;
 -0.0002361, -0.0001713 ,  8.738e-005,  0.0004984 ,  0.000671 ,  0.0001364, -0.001131 , -0.002499 , -0.003092 , -0.002499 , -0.001131 ,  0.0001364,  0.000671 ,  0.0004984 ,  8.738e-005, -0.0001713 , -0.0002361;
 -0.000765 ,  0.0002645 ,  0.001129  ,  0.000671  , -0.001072 , -0.002963 , -0.003947 , -0.004002 , -0.003872 , -0.004002 , -0.003947 , -0.002963 , -0.001072 ,  0.000671  ,  0.001129  ,  0.0002645 , -0.000765 ;
 -0.001149 ,  0.0007913 ,  0.001903  ,  0.0001364 , -0.002963 , -0.003513 ,  0.0004302,  0.006277 ,  0.009057 ,  0.006277 ,  0.0004302, -0.003513 , -0.002963 ,  0.0001364 ,  0.001903  ,  0.0007913 , -0.001149 ;
 -0.001186 ,  0.001152  ,  0.001887  , -0.001131  , -0.003947 ,  0.0004302,  0.01408  ,  0.03001  ,  0.0371   ,  0.03001  ,  0.01408  ,  0.0004302, -0.003947 , -0.001131  ,  0.001887  ,  0.001152  , -0.001186 ;
 -0.0009932,  0.001289  ,  0.00135   , -0.002499  , -0.004002 ,  0.006277 ,  0.03001  ,  0.05587  ,  0.06713  ,  0.05587  ,  0.03001  ,  0.006277 , -0.004002 , -0.002499  ,  0.00135   ,  0.001289  , -0.0009932;
 -0.0008756,  0.00131   ,  0.00104   , -0.003092  , -0.003872 ,  0.009057 ,  0.0371   ,  0.06713  ,  0.08013  ,  0.06713  ,  0.0371   ,  0.009057 , -0.003872 , -0.003092  ,  0.00104   ,  0.00131   , -0.0008756;
 -0.0009932,  0.001289  ,  0.00135   , -0.002499  , -0.004002 ,  0.006277 ,  0.03001  ,  0.05587  ,  0.06713  ,  0.05587  ,  0.03001  ,  0.006277 , -0.004002 , -0.002499  ,  0.00135   ,  0.001289  , -0.0009932;
 -0.001186 ,  0.001152  ,  0.001887  , -0.001131  , -0.003947 ,  0.0004302,  0.01408  ,  0.03001  ,  0.0371   ,  0.03001  ,  0.01408  ,  0.0004302, -0.003947 , -0.001131  ,  0.001887  ,  0.001152  , -0.001186 ;
 -0.001149 ,  0.0007913 ,  0.001903  ,  0.0001364 , -0.002963 , -0.003513 ,  0.0004302,  0.006277 ,  0.009057 ,  0.006277 ,  0.0004302, -0.003513 , -0.002963 ,  0.0001364 ,  0.001903  ,  0.0007913 , -0.001149 ;
 -0.000765 ,  0.0002645 ,  0.001129  ,  0.000671  , -0.001072 , -0.002963 , -0.003947 , -0.004002 , -0.003872 , -0.004002 , -0.003947 , -0.002963 , -0.001072 ,  0.000671  ,  0.001129  ,  0.0002645 , -0.000765 ;
 -0.0002361, -0.0001713 ,  8.738e-005,  0.0004984 ,  0.000671 ,  0.0001364, -0.001131 , -0.002499 , -0.003092 , -0.002499 , -0.001131 ,  0.0001364,  0.000671 ,  0.0004984 ,  8.738e-005, -0.0001713 , -0.0002361;
  0.0001194, -0.0002745 , -0.0004537 ,  8.738e-005,  0.001129 ,  0.001903 ,  0.001887 ,  0.00135  ,  0.00104  ,  0.00135  ,  0.001887 ,  0.001903 ,  0.001129 ,  8.738e-005, -0.0004537 , -0.0002745 ,  0.0001194;
  0.0001806, -6.354e-005, -0.0002745 , -0.0001713 ,  0.0002645,  0.0007913,  0.001152 ,  0.001289 ,  0.00131  ,  0.001289 ,  0.001152 ,  0.0007913,  0.0002645, -0.0001713 , -0.0002745 , -6.354e-005,  0.0001806;
  0.0001054,  0.0001806 ,  0.0001194 , -0.0002361 , -0.000765 , -0.001149 , -0.001186 , -0.0009932, -0.0008756, -0.0009932, -0.001186 , -0.001149 , -0.000765 , -0.0002361 ,  0.0001194 ,  0.0001806 ,  0.0001054];

 B1 = ...
[ 6.894e-005, -0.0003656 , -7.188e-005,  0.0004895, -0.0006697 , -0.0004985 ,  0.002933  ,  0.006564  ,  0.008115,  0.006564  ,  0.002933  , -0.0004985 , -0.0006697 ,  0.0004895, -7.188e-005, -0.0003656 ,  6.894e-005;
 -0.0004472 , -5.824e-006, -4.293e-005, -0.0008298,  0.0004919 ,  0.000618  , -0.002591  , -0.006201  , -0.007541, -0.006201  , -0.002591  ,  0.000618  ,  0.0004919 , -0.0008298, -4.293e-005, -5.824e-006, -0.0004472 ;
 -0.0003134 , -0.0005642 , -0.0007426 ,  0.0002954, -0.0006642 , -0.0007427 ,  0.003302  ,  0.007724  ,  0.009217,  0.007724  ,  0.003302  , -0.0007427 , -0.0006642 ,  0.0002954, -0.0007426 , -0.0005642 , -0.0003134 ;
 -0.0006143 , -0.0006075 , -0.0004488 , -0.001255 , -0.0007215 ,  0.000525  , -0.00307   , -0.006124  , -0.006587, -0.006124  , -0.00307   ,  0.000525  , -0.0007215 , -0.001255 , -0.0004488 , -0.0006075 , -0.0006143 ;
 -0.0006189 , -0.0008106 , -0.001007  , -0.001122 , -0.001046  , -0.002147  ,  0.006375  ,  0.01606   ,  0.01841 ,  0.01606   ,  0.006375  , -0.002147  , -0.001046  , -0.001122 , -0.001007  , -0.0008106 , -0.0006189 ;
 -0.0007615 , -0.0006683 , -0.001279  , -0.001402 , -0.002884  , -0.0001592 , -0.00662   , -0.01636   , -0.0137  , -0.01636   , -0.00662   , -0.0001592 , -0.002884  , -0.001402 , -0.001279  , -0.0006683 , -0.0007615 ;
 -0.0005313 , -0.0008639 , -0.0009893 , -0.001994 , -0.002682  , -0.008504  , -0.01024   ,  0.02913   ,  0.06156 ,  0.02913   , -0.01024   , -0.008504  , -0.002682  , -0.001994 , -0.0009893 , -0.0008639 , -0.0005313 ;
 -0.0003643 , -0.0004488 , -0.000623  , -0.001335 , -0.00305   , -0.008582  , -0.02226   , -0.1146    , -0.2013  , -0.1146    , -0.02226   , -0.008582  , -0.00305   , -0.001335 , -0.000623  , -0.0004488 , -0.0003643 ;
  4.691e-019, -3.429e-018, -3.953e-018,  1.27e-018, -1.581e-018, -2.525e-018, -1.319e-017, -4.057e-017,  0       ,  4.057e-017,  1.319e-017,  2.525e-018,  1.581e-018, -1.27e-018,  3.953e-018,  3.429e-018, -4.691e-019;
  0.0003643 ,  0.0004488 ,  0.000623  ,  0.001335 ,  0.00305   ,  0.008582  ,  0.02226   ,  0.1146    ,  0.2013  ,  0.1146    ,  0.02226   ,  0.008582  ,  0.00305   ,  0.001335 ,  0.000623  ,  0.0004488 ,  0.0003643 ;
  0.0005313 ,  0.0008639 ,  0.0009893 ,  0.001994 ,  0.002682  ,  0.008504  ,  0.01024   , -0.02913   , -0.06156 ,  -0.02913  ,  0.01024   ,  0.008504  ,  0.002682  ,  0.001994 ,  0.0009893 ,  0.0008639 ,  0.0005313 ;
  0.0007615 ,  0.0006683 ,  0.001279  ,  0.001402 ,  0.002884  ,  0.0001592 ,  0.00662   ,  0.01636   ,  0.0137  ,   0.01636  ,  0.00662   ,  0.0001592 ,  0.002884  ,  0.001402 ,  0.001279  ,  0.0006683 ,  0.0007615 ;
  0.0006189 ,  0.0008106 ,  0.001007  ,  0.001122 ,  0.001046  ,  0.002147  , -0.006375  , -0.01606   , -0.01841 ,  -0.01606  , -0.006375  ,  0.002147  ,  0.001046  ,  0.001122 ,  0.001007  ,  0.0008106 ,  0.0006189 ;
  0.0006143 ,  0.0006075 ,  0.0004488 ,  0.001255 ,  0.0007215 , -0.000525  ,  0.00307   ,  0.006124  ,  0.006587,  0.006124  ,  0.00307   , -0.000525  ,  0.0007215 ,  0.001255 ,  0.0004488 ,  0.0006075 ,  0.0006143 ;
  0.0003134 ,  0.0005642 ,  0.0007426 , -0.0002954,  0.0006642 ,  0.0007427 , -0.003302  , -0.007724  , -0.009217, -0.007724  , -0.003302  ,  0.0007427 ,  0.0006642 , -0.0002954,  0.0007426 ,  0.0005642 ,  0.0003134 ;
  0.0004472 ,  5.824e-006,  4.293e-005,  0.0008298, -0.0004919 , -0.000618  ,  0.002591  ,  0.006201  ,  0.007541,  0.006201  ,  0.002591  , -0.000618  , -0.0004919 ,  0.0008298,  4.293e-005,  5.824e-006,  0.0004472 ;
 -6.894e-005,  0.0003656 ,  7.188e-005, -0.0004895,  0.0006697 ,  0.0004985 , -0.002933  , -0.006564  , -0.008115, -0.006564  , -0.002933  ,  0.0004985 ,  0.0006697 , -0.0004895,  7.188e-005,  0.0003656 , -6.894e-005];

 B2 = ...
[  0.0003558 , -0.0001843 ,  0.0004487 ,  0.0009291 ,  0.0001515 , -0.0002366 ,  0.001597  ,  0.002623  ,  0.003054,  0.001951  ,  0.0005134 , -0.001022  , -0.000908  ,  1.384e-005, -0.000245  , -0.0001965 ,  1.643e-010;
  -0.0001843 ,  0.0006936 ,  0.0008223 , -0.0002141 ,  0.00112   ,  0.001419  , -0.001015  , -0.003051  , -0.00347 , -0.002977  , -0.001412  , -0.0004186 ,  7.739e-005, -0.0007507 ,  0.0001265 ,  3.543e-010,  0.0001965 ;
   0.0004487 ,  0.0008223 , -0.0002859 ,  0.002021  ,  0.0004746 , -0.0004098 ,  0.001822  ,  0.003226  ,  0.002146,  0.0009752 , -0.000598  , -0.0009649 , -0.0009054 ,  0.0002344 ,  2.155e-010, -0.0001265 ,  0.000245  ;
   0.0009292 , -0.0002141 ,  0.002021  ,  7.098e-005,  0.0007462 ,  0.002801  , -0.001843  , -0.004408  , -0.004741, -0.003814  , -0.002285  , -0.0005543 , -0.0002495 , -2.598e-010, -0.0002344 ,  0.0007507 , -1.384e-005;
   0.0001515 ,  0.00112   ,  0.0004746 ,  0.0007462 ,  0.003053  , -0.0006275 ,  0.008091  ,  0.00789   ,  0.0011  , -0.002721  , -0.002112  , -0.001548  , -9.602e-010,  0.0002495 ,  0.0009054 , -7.739e-005,  0.000908  ;
  -0.0002366 ,  0.001419  , -0.0004098 ,  0.002801  , -0.0006275 ,  0.01247   ,  0.0004439 , -0.01615   , -0.01455 , -0.01201   , -0.003823  , -1.552e-009,  0.001548  ,  0.0005543 ,  0.0009649 ,  0.0004186 ,  0.001022  ;
   0.001597  , -0.001015  ,  0.001822  , -0.001843  ,  0.008091  ,  0.000444  ,  0.001775  ,  0.04179   , -0.01826 , -0.02      , -2.055e-009,  0.003823  ,  0.002112  ,  0.002285  ,  0.000598  ,  0.001412  , -0.0005134 ;
   0.002623  , -0.003051  ,  0.003226  , -0.004408  ,  0.00789   , -0.01615   ,  0.04179   , -0.06839   , -0.1803  ,  7.953e-010,  0.02      ,  0.01201   ,  0.002721  ,  0.003814  , -0.0009752 ,  0.002977  , -0.001951  ;
   0.003054  , -0.00347   ,  0.002146  , -0.004741  ,  0.0011    , -0.01455   , -0.01826   , -0.1803    ,  0       ,  0.1803    ,  0.01826   ,  0.01455   , -0.0011    ,  0.004741  , -0.002146  ,  0.00347   , -0.003054  ;
   0.001951  , -0.002977  ,  0.0009752 , -0.003814  , -0.002721  , -0.01201   , -0.02      , -7.953e-010,  0.1803  ,  0.06839   , -0.04179   ,  0.01615   , -0.00789   ,  0.004408  , -0.003226  ,  0.003051  , -0.002623  ;
   0.0005134 , -0.001412  , -0.000598  , -0.002285  , -0.002112  , -0.003823  ,  2.055e-009,  0.02      ,  0.01826 , -0.04179   , -0.001775  , -0.000444  , -0.008091  ,  0.001843  , -0.001822  ,  0.001015  , -0.001597  ;
  -0.001022  , -0.0004186 , -0.0009649 , -0.0005543 , -0.001548  ,  1.552e-009,  0.003823  ,  0.01201   ,  0.01455 ,  0.01615   , -0.0004439 , -0.01247   ,  0.0006275 , -0.002801  ,  0.0004098 , -0.001419  ,  0.0002366 ;
  -0.000908  ,  7.739e-005, -0.0009054 , -0.0002495 ,  9.602e-010,  0.001548  ,  0.002112  ,  0.002721  , -0.0011  , -0.00789   , -0.008091  ,  0.0006275 , -0.003053  , -0.0007462 , -0.0004746 , -0.00112   , -0.0001515 ;
   1.384e-005, -0.0007507 ,  0.0002344 ,  2.598e-010,  0.0002495 ,  0.0005543 ,  0.002285  ,  0.003814  ,  0.004741,  0.004408  ,  0.001843  , -0.002801  , -0.0007462 , -7.098e-005, -0.002021  ,  0.0002141 , -0.0009292 ;
  -0.000245  ,  0.0001265 , -2.155e-010, -0.0002344 ,  0.0009054 ,  0.0009649 ,  0.000598  , -0.0009752 , -0.002146, -0.003226  , -0.001822  ,  0.0004098 , -0.0004746 , -0.002021  ,  0.0002859 , -0.0008223 , -0.0004487 ;
  -0.0001965 , -3.543e-010, -0.0001265 ,  0.0007507 , -7.739e-005,  0.0004186 ,  0.001412  ,  0.002977  ,  0.00347 ,  0.003051  ,  0.001015  , -0.001419  , -0.00112   ,  0.0002141 , -0.0008223 , -0.0006936 ,  0.0001843 ;
  -1.643e-010,  0.0001965 ,  0.000245  , -1.384e-005,  0.000908  ,  0.001022  , -0.0005134 , -0.001951  , -0.003054, -0.002623  , -0.001597  ,  0.0002366 , -0.0001515 , -0.0009291 , -0.0004487 ,  0.0001843 , -0.0003558 ];

 B3 = ...
[ 6.894e-005, -0.0004472 , -0.0003134, -0.0006143, -0.0006188, -0.0007615, -0.0005313, -0.0003643, -3.497e-018, 0.0003643,  0.0005313, 0.0007615,  0.0006188,  0.0006143,  0.0003134,  0.0004472 , -6.894e-005;
 -0.0003656 , -5.822e-006, -0.0005642, -0.0006075, -0.0008106, -0.0006683, -0.0008639, -0.0004488, -6.345e-018, 0.0004488,  0.0008639, 0.0006683,  0.0008106,  0.0006075,  0.0005642,  5.822e-006,  0.0003656 ;
 -7.188e-005, -4.293e-005, -0.0007426, -0.0004487, -0.001007 , -0.001279 , -0.0009893, -0.000623 , -4.158e-018, 0.000623 ,  0.0009893, 0.001279 ,  0.001007 ,  0.0004487,  0.0007426,  4.293e-005,  7.188e-005;
  0.0004895 , -0.0008298 ,  0.0002954, -0.001255 , -0.001122 , -0.001402 , -0.001994 , -0.001335 , -1.16e-018 , 0.001335 ,  0.001994 , 0.001402 ,  0.001122 ,  0.001255 , -0.0002954,  0.0008298 , -0.0004895 ;
 -0.0006697 ,  0.0004919 , -0.0006642, -0.0007215, -0.001046 , -0.002884 , -0.002682 , -0.00305  ,  2.562e-018, 0.00305  ,  0.002682 , 0.002884 ,  0.001046 ,  0.0007215,  0.0006642, -0.0004919 ,  0.0006697 ;
 -0.0004985 ,  0.000618  , -0.0007427,  0.000525 , -0.002147 , -0.0001592, -0.008504 , -0.008582 ,  8.067e-018, 0.008582 ,  0.008504 , 0.0001592,  0.002147 , -0.000525 ,  0.0007427, -0.000618  ,  0.0004985 ;
  0.002933  , -0.002591  ,  0.003302 , -0.00307  ,  0.006375 , -0.00662  , -0.01024  , -0.02226  ,  1.436e-017, 0.02226  ,  0.01024  , 0.00662  , -0.006375 ,  0.00307  , -0.003302 ,  0.002591  , -0.002933  ;
  0.006564  , -0.006201  ,  0.007724 , -0.006124 ,  0.01606  , -0.01636  ,  0.02913  , -0.1146   ,  2.484e-017, 0.1146   , -0.02913  , 0.01636  , -0.01606  ,  0.006124 , -0.007724 ,  0.006201  , -0.006564  ;
  0.008115  , -0.007541  ,  0.009217 , -0.006587 ,  0.01841  , -0.0137   ,  0.06156  , -0.2013   ,  0         , 0.2013   , -0.06156  , 0.0137   , -0.01841  ,  0.006587 , -0.009217 ,  0.007541  , -0.008115  ;
  0.006564  , -0.006201  ,  0.007724 , -0.006124 ,  0.01606  , -0.01636  ,  0.02913  , -0.1146   , -2.484e-017, 0.1146   , -0.02913  , 0.01636  , -0.01606  ,  0.006124 , -0.007724 ,  0.006201  , -0.006564  ;
  0.002933  , -0.002591  ,  0.003302 , -0.00307  ,  0.006375 , -0.00662  , -0.01024  , -0.02226  , -1.436e-017, 0.02226  ,  0.01024  , 0.00662  , -0.006375 ,  0.00307  , -0.003302 ,  0.002591  , -0.002933  ;
 -0.0004985 ,  0.000618  , -0.0007427,  0.000525 , -0.002147 , -0.0001592, -0.008504 , -0.008582 , -8.067e-018, 0.008582 ,  0.008504 , 0.0001592,  0.002147 , -0.000525 ,  0.0007427, -0.000618  ,  0.0004985 ;
 -0.0006697 ,  0.0004919 , -0.0006642, -0.0007215, -0.001046 , -0.002884 , -0.002682 , -0.00305  , -2.562e-018, 0.00305  ,  0.002682 , 0.002884 ,  0.001046 ,  0.0007215,  0.0006642, -0.0004919 ,  0.0006697 ;
  0.0004895 , -0.0008298 ,  0.0002954, -0.001255 , -0.001122 , -0.001402 , -0.001994 , -0.001335 ,  1.16e-018 , 0.001335 ,  0.001994 , 0.001402 ,  0.001122 ,  0.001255 , -0.0002954,  0.0008298 , -0.0004895 ;
 -7.188e-005, -4.293e-005, -0.0007426, -0.0004487, -0.001007 , -0.001279 , -0.0009893, -0.000623 ,  4.158e-018, 0.000623 ,  0.0009893, 0.001279 ,  0.001007 ,  0.0004487,  0.0007426,  4.293e-005,  7.188e-005;
 -0.0003656 , -5.822e-006, -0.0005642, -0.0006075, -0.0008106, -0.0006683, -0.0008639, -0.0004488,  6.345e-018, 0.0004488,  0.0008639, 0.0006683,  0.0008106,  0.0006075,  0.0005642,  5.822e-006,  0.0003656 ;
  6.894e-005, -0.0004472 , -0.0003134, -0.0006143, -0.0006188, -0.0007615, -0.0005313, -0.0003643,  3.497e-018, 0.0003643,  0.0005313, 0.0007615,  0.0006188,  0.0006143,  0.0003134,  0.0004472 , -6.894e-005];

 B4 = ...
[-1.643e-010,  0.0001965 ,  0.000245  , -1.384e-005,  0.000908  ,  0.001022  , -0.0005134 , -0.001951  , -0.003054, -0.002623  , -0.001597  ,  0.0002366 , -0.0001515 , -0.0009291 , -0.0004487 ,  0.0001843 , -0.0003558 ;
 -0.0001965 , -3.543e-010, -0.0001265 ,  0.0007507 , -7.739e-005,  0.0004186 ,  0.001412  ,  0.002977  ,  0.00347 ,  0.003051  ,  0.001015  , -0.001419  , -0.00112   ,  0.0002141 , -0.0008223 , -0.0006936 ,  0.0001843 ;
 -0.000245  ,  0.0001265 , -2.155e-010, -0.0002344 ,  0.0009054 ,  0.0009649 ,  0.000598  , -0.0009752 , -0.002146, -0.003226  , -0.001822  ,  0.0004098 , -0.0004746 , -0.002021  ,  0.0002859 , -0.0008223 , -0.0004487 ;
  1.384e-005, -0.0007507 ,  0.0002344 ,  2.598e-010,  0.0002495 ,  0.0005543 ,  0.002285  ,  0.003814  ,  0.004741,  0.004408  ,  0.001843  , -0.002801  , -0.0007462 , -7.098e-005, -0.002021  ,  0.0002141 , -0.0009292 ;
 -0.000908  ,  7.739e-005, -0.0009054 , -0.0002495 ,  9.602e-010,  0.001548  ,  0.002112  ,  0.002721  , -0.0011  , -0.00789   , -0.008091  ,  0.0006275 , -0.003053  , -0.0007462 , -0.0004746 , -0.00112   , -0.0001515 ;
 -0.001022  , -0.0004186 , -0.0009649 , -0.0005543 , -0.001548  ,  1.552e-009,  0.003823  ,  0.01201   ,  0.01455 ,  0.01615   , -0.0004439 , -0.01247   ,  0.0006275 , -0.002801  ,  0.0004098 , -0.001419  ,  0.0002366 ;
  0.0005134 , -0.001412  , -0.000598  , -0.002285  , -0.002112  , -0.003823  ,  2.055e-009,  0.02      ,  0.01826 , -0.04179   , -0.001775  , -0.000444  , -0.008091  ,  0.001843  , -0.001822  ,  0.001015  , -0.001597  ;
  0.001951  , -0.002977  ,  0.0009752 , -0.003814  , -0.002721  , -0.01201   , -0.02      , -7.953e-010,  0.1803  ,  0.06839   , -0.04179   ,  0.01615   , -0.00789   ,  0.004408  , -0.003226  ,  0.003051  , -0.002623  ;
  0.003054  , -0.00347   ,  0.002146  , -0.004741  ,  0.0011    , -0.01455   , -0.01826   , -0.1803    ,  0       ,  0.1803    ,  0.01826   ,  0.01455   , -0.0011    ,  0.004741  , -0.002146  ,  0.00347   , -0.003054  ;
  0.002623  , -0.003051  ,  0.003226  , -0.004408  ,  0.00789   , -0.01615   ,  0.04179   , -0.06839   , -0.1803  ,  7.953e-010,  0.02      ,  0.01201   ,  0.002721  ,  0.003814  , -0.0009752 ,  0.002977  , -0.001951  ;
  0.001597  , -0.001015  ,  0.001822  , -0.001843  ,  0.008091  ,  0.000444  ,  0.001775  ,  0.04179   , -0.01826 , -0.02      , -2.055e-009,  0.003823  ,  0.002112  ,  0.002285  ,  0.000598  ,  0.001412  , -0.0005134 ;
 -0.0002366 ,  0.001419  , -0.0004098 ,  0.002801  , -0.0006275 ,  0.01247   ,  0.0004439 , -0.01615   , -0.01455 , -0.01201   , -0.003823  , -1.552e-009,  0.001548  ,  0.0005543 ,  0.0009649 ,  0.0004186 ,  0.001022  ;
  0.0001515 ,  0.00112   ,  0.0004746 ,  0.0007462 ,  0.003053  , -0.0006275 ,  0.008091  ,  0.00789   ,  0.0011  , -0.002721  , -0.002112  , -0.001548  , -9.602e-010,  0.0002495 ,  0.0009054 , -7.739e-005,  0.000908  ;
  0.0009292 , -0.0002141 ,  0.002021  ,  7.098e-005,  0.0007462 ,  0.002801  , -0.001843  , -0.004408  , -0.004741, -0.003814  , -0.002285  , -0.0005543 , -0.0002495 , -2.598e-010, -0.0002344 ,  0.0007507 , -1.384e-005;
  0.0004487 ,  0.0008223 , -0.0002859 ,  0.002021  ,  0.0004746 , -0.0004098 ,  0.001822  ,  0.003226  ,  0.002146,  0.0009752 , -0.000598  , -0.0009649 , -0.0009054 ,  0.0002344 ,  2.155e-010, -0.0001265 ,  0.000245  ;
 -0.0001843 ,  0.0006936 ,  0.0008223 , -0.0002141 ,  0.00112   ,  0.001419  , -0.001015  , -0.003051  , -0.00347 , -0.002977  , -0.001412  , -0.0004186 ,  7.739e-005, -0.0007507 ,  0.0001265 ,  3.543e-010,  0.0001965 ;
  0.0003558 , -0.0001843 ,  0.0004487 ,  0.0009291 ,  0.0001515 , -0.0002366 ,  0.001597  ,  0.002623  ,  0.003054,  0.001951  ,  0.0005134 , -0.001022  , -0.000908  ,  1.384e-005, -0.000245  , -0.0001965 ,  1.643e-010];

%% Pyramid building

high_pass = conv2(im, H0, 'same');
initial_low_pass = conv2(im, L0, 'same');

band1 = conv2(initial_low_pass, B1, 'same');
band2 = conv2(initial_low_pass, B2, 'same');
band3 = conv2(initial_low_pass, B3, 'same');
band4 = conv2(initial_low_pass, B4, 'same');

second_low_pass = conv2(initial_low_pass, L1, 'same');
down_sampled = downsampleImage(second_low_pass);


end

